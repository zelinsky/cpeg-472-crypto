# ninja{h4v3_you_cr4ck3d_F3rmats_L4st_Th30r3m}

from Crypto.Util.number import *

ct = 27398206847706137791682018598384312261224933354013461238100738652698331173127592124602110290674636446639746081491160166743083265357744917585333929445921386191092372052983689907999035279828854874739601766122065601411241299313754046703511636722729391661973288612926181054047821512635228863611450007178811845789173859598215555708346951090943434447204769927171921319083123571159980058592139638863946388127405075564806017023182399797952327642754970222762488886261634153663415885468485187898607044325830506627277358897664372757365127413725518240689379550391365605079743306073407081255579508510836328701980583871806352516798
e = 65537
n = 29897401988171068052544577847863798426436266377462895527046487004332762438249343351654655432404547609856485586651654378138194842654101490118776705218853987568525468434966196180899505142655267867805993555646357928778020705857202189147998581912241865952588555368112297178839430244795711651679891606831272766445452693326769604013900657120589648808198162884147521504334326063754529028194691916333560824476933340900043866995874085876517377160528948459780335439760227252699121482073607459780985646582559918499453338594733911159409808816381642797625391117240759286612615907625128485476802461337827503583483605794680990167417

def isqrt(n):
  x = n
  y = (x + n // x) // 2
  while y < x:
    x = y
    y = (x + n // x) // 2
  return x

def fermat(n, verbose=True):
    a = isqrt(n) # int(ceil(n**0.5))
    b2 = a*a - n
    b = isqrt(n) # int(b2**0.5)
    count = 0
    while b*b != b2:
        if verbose:
            print('Trying: a=%s b2=%s b=%s' % (a, b2, b))
        a = a + 1
        b2 = a*a - n
        b = isqrt(b2) # int(b2**0.5)
        count += 1
    p=a+b
    q=a-b
    assert n == p * q
    print('a=',a)
    print('b=',b)
    print('p=',p)
    print('q=',q)
    print('pq=',p*q)
    return p, q

p, q = fermat(n, False)
phi = (p-1)*(q-1)
d = inverse(e, phi)
m = long_to_bytes(pow(ct, d, n))
print m